<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>rnn-em | An old brother's memo.</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/." class="title">An old brother's memo.</a><span class="subtitle"></span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/" class="sidebar-nav-item active">Home</a><a href="/archives" class="sidebar-nav-item">Archives</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>rnn-em</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">2016-07-14</div><div class="post-categories"><a class="post-category-link" href="/categories/machine-learning/">machine learning</a></div><div class="post-tags"><a class="post-tag-link" href="/tags/deep-learning/">deep learning</a></div></div></div><article><div class="container post"><p><a class="btn btn-default" href="https://github.com/npow/RNN-EM" target="_blank">GitHub</a></p>
<h2 id="External-memory-read"><a href="#External-memory-read" class="headerlink" title="External memory read"></a>External memory read</h2><p>RNN-EM has an external memory $M_t \in R^{m\times n}$. It can be considered as a memory with $n$ slots and each slot is a vector with $m$ elements. Similar to the external memory in computers, the memory capacity of RNN-EM may be increased if using a large $n$.</p>
<p>The model generates a key vector $k_t$ to search for content in the external memory. Though there are many possible ways to generate the key vector, we choose a simple linear function that relates hidden layer activity $h_t$ as follows<br>$$<br>k_t=W_kh_t<br>$$<br>where $W_k\in R^{m\times p}$ is a linear transformation matrix. Our intuition is that the memory should be in the same space of or affine to the hidden layer activity.</p>
<p>We use cosine distance $K(u,v)={u\cdot v \over ||u||||v||}$ to compare this key vector with contents in the external memory. The weight for the $c$-th slot $M_t(:,c)$ in memory $M_t$ is computed as follows<br>$$<br>\hat w_t(c)=\frac{exp\beta_tK(k_t,M_t(:,c))}{\sum_qexp\beta_tK(k_t,M_t(:,q))}<br>$$<br>where the above weight is normalized and sums to 1.0. $\beta_t$ is a scalar larger than 0.0. It sharpens the weight vector when $\beta_t$ is larger than 1.0. Conversely, it smooths or dampens the weight vector when $\beta_t$ is between 0.0 and 1.0. We use the following function to obtain $\beta_t$;<br>$$<br>\beta<em>t=log(1+exp(W</em>\beta h<em>t))<br>$$<br>where $W</em>\beta\in R^{1\times p}$ maps the hidden layer activity $h_t$ to a scalar.</p>
<p>Importantly, we also use a scalar coefficient $g_t$ to interpolate the above weight estimate with the past weight as follows<br>$$<br>w_t=(1-g<em>t)w</em>{t-1}+g_t\hat w_t<br>$$</p>
<p>The memory content is retrieved from the external memory at time $t-1$ using<br>$$<br>c<em>t=M</em>{t-1}w_{t-1}<br>$$</p>
<h2 id="External-memory-update"><a href="#External-memory-update" class="headerlink" title="External memory update"></a>External memory update</h2><p>RNN-EM generates a new content vector $v_t$ to be added to its memory<br>$$<br>v_t=W_vh_t<br>$$<br>where $W_v\in R^{m\times p}$.</p>
<p>RNN-EM has a forget gate as follows<br>$$<br>f_t=1-w_t\odot e_t<br>$$<br>where $e_t\in R^{n\times 1}$ is an erase vector, generated as $e<em>t=\sigma(W</em>{he}h_t)$. Notice that the $c$-th element in the forget gate is zero only if both read weight $w_t$ and erase vector $e_t$ have their $c$-th element set to one. Therefore, memory cannot be forgotten if it is not to be read.</p>
<p>RNN-EM has an update gate $u_t$. It simply uses the weight $w_t$ as follows<br>$$<br>u_t=w_t<br>$$<br>Therefore, memory is only updated if it is to be read.</p>
<p>With the above described two gates, the memory is updated as follows<br>$$<br>M_t=diag(f<em>t)M</em>{t-1}+diag(u_t)v_t<br>$$<br>where $diag(\cdot)$ transforms a vector to a diagonal matrix with diagonal elements from the vector.</p>
<p>Notice that when the number of memory slots is small, it may have similar performances as a geted RNN.</p>
</div><!-- comment system--><div class="container"><hr></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="mailto:dad@sdz.red" target="_blank"><i class="fa fa-envelope-o"></i></a><a href="https://github.com/sohero" target="_blank"><i class="fa fa-github"></i></a><script>var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cspan id='cnzz_stat_icon_1261298720'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1261298720%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
</script></div><div class="footer">Â© 2017 <a href="/" rel="nofollow">Hero Memo</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><script>MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body></html>